/*!
*  filename: ej2-office-chart.min.js
*  version : 20.3.56
*  Copyright Syncfusion Inc. 2001 - 2020. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("SyncfusionBase"),require("SyncfusionCharts"),require("SyncfusionSvgBase")):"function"==typeof define&&define.amd?define(["SyncfusionBase","SyncfusionCharts","SyncfusionSvgBase"],t):"object"==typeof exports?exports.SyncfusionOfficeChart=t(require("SyncfusionBase"),require("SyncfusionCharts"),require("SyncfusionSvgBase")):e.SyncfusionOfficeChart=t(e.SyncfusionBase,e.SyncfusionCharts,e.SyncfusionSvgBase)}(this,function(e,t,r){return function(e){function t(a){if(r[a])return r[a].exports;var i=r[a]={i:a,l:!1,exports:{}};return e[a].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var r={};return t.m=e,t.c=r,t.i=function(e){return e},t.d=function(e,r,a){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:a})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=1)}([function(e,t,r){"use strict";var a=r(2);r.d(t,"a",function(){return a.a})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(0);r.d(t,"ChartComponent",function(){return a.a})},function(e,t,r){"use strict";r.d(t,"a",function(){return o});var a=r(4),i=(r.n(a),r(5)),n=(r.n(i),r(3));r.n(n);a.Chart.Inject(a.AreaSeries,a.StackingAreaSeries,a.BarSeries,a.PieSeries,a.StackingBarSeries,a.PolarSeries,a.ScatterSeries,a.BubbleSeries,a.RadarSeries,a.DateTime,a.ColumnSeries,a.StackingColumnSeries,a.LineSeries,a.StackingLineSeries,a.ErrorBar,a.Trendlines,a.SplineSeries,a.DataLabel,a.Category,a.Legend,a.Tooltip,a.Export),a.AccumulationChart.Inject(a.AccumulationLegend,a.PieSeries,a.AccumulationTooltip,a.AccumulationDataLabel);var o=function(){function e(){}return e.prototype.chartRender=function(e){this.chartType=e.chartType,this.isPieType="Pie"===this.chartType||"Doughnut"===this.chartType;var t=this.chartData(e,this.chartType),r={enableAnimation:!1,width:e.width*(96/72)+"px",height:e.height*(96/72)+"px"};this.isPieType?this.chart=new a.AccumulationChart(r):(this.chart=new a.Chart(r),this.chart.primaryXAxis=this.chartPrimaryXAxis(e.chartPrimaryCategoryAxis,this.chartType),this.chart.primaryYAxis=this.chartPrimaryYAxis(e.chartPrimaryValueAxis)),this.chart.series=this.chartSeries(e.chartSeries,t,this.chartType);for(var i=0;i<this.chart.series.length;i++)this.chart.series[i].animation.enable=!1;this.chart.title=e.chartTitle,this.chart.legendSettings=this.parseChartLegend(e.chartLegend)},e.prototype.convertChartToImage=function(e,t,a){var i=this;return new Promise(function(o,s){var c=0,u=0,h=i.getControlsValue([e],t,a);c=c||h.width,u=u||h.height;var l=r.i(n.createElement)("canvas"),p=Math.max(1,window.devicePixelRatio||1);l.width=c*p,l.height=u*p,l.style.width=c+"px",l.style.height=u+"px";var d=window.URL.createObjectURL(new Blob([(new XMLSerializer).serializeToString(h.svg)],{type:"image/svg+xml"})),f=new Image,y=l.getContext("2d");y.scale(p,p),f.onload=function(){y.drawImage(f,0,0),window.URL.revokeObjectURL(d);var e=l.toDataURL("image/png");o(e)},f.onerror=function(){s("Invalid data")},f.src=d})},e.prototype.getControlsValue=function(e,t,r){var a=0,n=0,o="",s=new i.SvgRenderer("").createSvg({id:"Image_Export",width:200,height:200});return e.map(function(e){if(e){var r=e.svgObject.cloneNode(!0),i=e.renderer.createGroup({style:"transform: translateY("+n+"px)"});i.appendChild(r),a=Math.max(e.availableSize.width,t),n+=e.availableSize.height,o+=e.svgObject.outerHTML,s.appendChild(i)}}),s.setAttribute("width",a+""),s.setAttribute("height",n+""),{width:a,height:n,svg:s}},e.prototype.officeChartType=function(e){var t="";switch(e){case"Area_Stacked":t="StackingArea";break;case"Area":t="Area";break;case"Area_Stacked_100":t="StackingArea100";break;case"Bar_Clustered":t="Bar";break;case"Bar_Stacked":t="StackingBar";break;case"Bar_Stacked_100":t="StackingBar100";break;case"Column_Clustered":t="Column";break;case"Column_Stacked":t="StackingColumn";break;case"Column_Stacked_100":t="StackingColumn100";break;case"Scatter_Markers":t="Scatter";break;case"Bubble":t="Bubble";break;case"Doughnut":case"Pie":t="Pie";break;case"Line_Stacked_100":case"Line_Markers_Stacked_100":t="StackingLine100";break;case"Line":case"Line_Markers":t="Line";break;case"Line_Stacked":case"Line_Markers_Stacked":t="StackingLine"}return t},e.prototype.chartSeries=function(e,t,r){for(var a=[],i=0;i<e.length;i++){var n=e[i],o=this.writeChartSeries(n,t,r,i);a.push(o)}return a},e.prototype.writeChartSeries=function(e,t,a,i){var o,s=this.officeChartType(a),c=e.dataPoints[i],u={};if(u.type=s,u.dataSource=t,u.name=e.seriesName,u.xName="x",u.yName="y"+i,"Bubble"===a&&(u.size="size"+i),this.isPieType?(u.pointColorMapping="color","Doughnut"===a&&(u.innerRadius="75%",u.radius="70%")):(r.i(n.isNullOrUndefined)(c)&&(c=e.dataPoints[0]),o=this.chartFormat(c,s),u.fill=o,r.i(n.isNullOrUndefined)(c.fill.foreColor)||(u.pointColorMapping="color")),"Line_Markers"!==a&&"Line_Markers_Stacked"!==a&&"Line_Markers_Stacked_100"!==a||(u.marker={visible:!0}),e.hasOwnProperty("dataLabel"))if(this.isPieType)u.dataLabel=this.parseDataLabels(e.dataLabel);else{var h={};h.dataLabel=this.parseDataLabels(e.dataLabel),u.marker=h}if(e.hasOwnProperty("errorBar")){var l=e.errorBar;u.errorBar=this.parseErrorBars(l)}if(e.hasOwnProperty("trendLines"))for(var p=e.trendLines,d=[],f=0;f<p.length;f++){var y=p[f],m={};m=this.parseTrendLines(y,o),d.push(m),u.trendlines=d}return u},e.prototype.parseDataLabels=function(e){var t={};return t.visible=!0,this.isPieType?"BestFit"===e.position||"Inside"===e.position?t.position="Inside":t.position="Outside":t.position=this.dataLabelPosition(e.position),t},e.prototype.parseErrorBars=function(e){var t={};return t.visible=!0,t.type=e.type,t.direction=e.direction,"Cap"===e.endStyle?t.errorBarCap={width:1}:t.errorBarCap={width:0},t},e.prototype.parseTrendLines=function(e,t){var r={};return r.type=e.type,r.name=e.name,r.forwardForecast=e.forward,r.backwardForecast=e.backward,"NaN"===e.intercept?r.intercept=0:r.intercept=e.intercept,r.fill=t,r},e.prototype.dataLabelPosition=function(e){var t="Auto";switch(e){case"Outside":t="Outer";break;case"Center":t="Middle";break;case"Inside":t="Top";break;case"OutsideBase":t="Bottom"}return t},e.prototype.chartFormat=function(e,t){var r=e;return"Line"===t||"StackingLine"===t||"StackingLine100"===t?r.line.rgb:r.fill.rgb},e.prototype.chartPrimaryXAxis=function(e,t){var r={};e.chartTitle&&(r.title=e.chartTitle);var a=this.chartCategoryType(e.categoryType);return r.valueType=a,"DateTime"===a&&(r.intervalType="Days",r.labelFormat="M/d/yyyy",r.edgeLabelPlacement="Shift"),"Scatter_Markers"!==t&&"Bubble"!==t||this.checkAndSetAxisValue(r,e),e.hasMajorGridLines&&(r.majorGridLines={width:1}),e.hasMinorGridLines&&(r.minorTicksPerInterval=4),r},e.prototype.chartCategoryType=function(e){var t="";switch(e){case"Time":t="DateTime";break;case"Automatic":t="Category"}return t},e.prototype.chartPrimaryYAxis=function(e){var t={};return e.chartTitle&&(t.title=e.chartTitle),this.checkAndSetAxisValue(t,e),e.hasMajorGridLines&&(t.majorGridLines={width:1}),e.hasMinorGridLines&&(t.minorTicksPerInterval=4),t},e.prototype.checkAndSetAxisValue=function(e,t){0!==t.minimumValue&&(e.minimum=t.minimumValue),0!==t.maximumValue&&(e.maximum=t.maximumValue),0!==t.majorUnit&&(e.interval=t.majorUnit)},e.prototype.chartData=function(e,t){for(var r=e.chartCategory,a=[],i=0;i<r.length;i++){var n=r[i],o=this.chartPlotData(n,e,t,i);a.push(o)}return a},e.prototype.chartPlotData=function(e,t,a,i){var o={},s=t.chartSeries;if("m/d/yyyy"===t.chartPrimaryCategoryAxis.numberFormat){var c=e.categoryXName,u=c.split("/"),h=Number(u[0]),l=Number(u[1]),p=Number(u[2]);o.x=new Date(p,h-1,l)}else o.x=e.categoryXName;for(var d=0;d<s.length;d++){var f=e.chartData[d];if(o["y"+d]=f.yValue,"Bubble"===a&&(o["size"+d]=f.size),"Pie"===t.chartType||"Doughnut"===t.chartType||"Column_Stacked"===t.chartType){var y=s[d],m=y.dataPoints.find(function(e){return e.id===i});r.i(n.isNullOrUndefined)(m)?y.dataPoints.length>1&&0===y.dataPoints[i].id?(m=y.dataPoints[i],o.color=this.chartFormat(m,a)):r.i(n.isNullOrUndefined)(y.seriesFormat)||r.i(n.isNullOrUndefined)(y.seriesFormat.fill)||y.seriesFormat.fill.rgb.length>7&&(o.color=this.getColor(y.seriesFormat.fill.rgb)):o.color=this.chartFormat(m,a)}}return o},e.prototype.getColor=function(e){return e.length>0&&"#"===e[0]&&e.length>7?e.substr(0,7):e},e.prototype.parseChartLegend=function(e){var t={},r=e.position;return"Corner"===r&&(r="right"),r?(t.visible=!0,t.position=r.charAt(0).toUpperCase()+r.slice(1)):t.visible=!1,t},e.prototype.destroy=function(){this.chart&&this.chart.destroy(),this.chart=void 0},e}()},function(t,r){t.exports=e},function(e,r){e.exports=t},function(e,t){e.exports=r}])});